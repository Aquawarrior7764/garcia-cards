<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>Garcia Cards – Matching Game</title>
  <link rel="stylesheet" href="memory.css?v=1.0.6" />
</head>
<body>

  <h1>Garcia Cards – Matching Game</h1>
  <button onclick="location.href='index.html'" style="margin: 10px auto; display: block;">Back to Collection</button>

  <div id="stripe">
    <span id="moves-and-stars">
      <span id="move-counter">0</span>
      <span id="move-plural"> Moves</span>
      <span id="stars">★★★</span>
    </span>
    <button id="reset">Reset</button>
    <span id="timer">Time: 0</span>
  </div>

  <div id="container">
    <!-- Cards will be dynamically generated -->
  </div>

  <div id="modal-container">
    <div id="modal">
      <div class="modal-text">You won!</div>
      <div id="win-text" class="modal-text"></div>
      <div class="modal-text">Press Reset to play again!</div>
    </div>
  </div>

  <div style="text-align: center; margin-top: 20px;">
    <button onclick="window.location.href='index.html'">← Back to Main Site</button>
  </div>

  <script>
    const ENCRYPTED_CARD_MAP = {
      a3x7kg: "gcu1", v7k9wm: "gcu2", ue3blt: "gcu3", z8tnyf: "gcu4", jq4huz: "gcu5",
      w2hdxp: "guc1", pt4mry: "guc2", ke2tqn: "guc3", dh6avf: "guc4",
      cx5nrz: "grc1", mf9zlx: "grc2", bt2dyg: "grc3",
      nr7vku: "gec1", sa4pjw: "gec2",
      qf3lta: "glc1", lh9vxm: "glc2"
    };

    const CARD_LIBRARY = {};
    for (const [enc, cardId] of Object.entries(ENCRYPTED_CARD_MAP)) {
      CARD_LIBRARY[cardId] = { image: `cards/${cardId}.png` };
    }

    const unlocked = JSON.parse(localStorage.getItem("scannedCards")) || [];
    const playable = Object.keys(CARD_LIBRARY).filter(id => unlocked.includes(id));
    const container = document.getElementById("container");

    const shuffled = playable.sort(() => 0.5 - Math.random());
const selected = shuffled.slice(0, Math.min(8, shuffled.length));
const gameCards = [...selected, ...selected].sort(() => 0.5 - Math.random());

gameCards.forEach(cardId => {
  const card = document.createElement("div");
  card.classList.add("card");
  card.dataset.cardId = cardId;

  const inner = document.createElement("div");
  inner.classList.add("card-inner");

  const front = document.createElement("div");
  front.classList.add("card-front");
  front.style.backgroundImage = `url('${CARD_LIBRARY[cardId].image}')`;

  const back = document.createElement("div");
  back.classList.add("card-back");

  inner.appendChild(front);
  inner.appendChild(back);
  card.appendChild(inner);
  container.appendChild(card);
});

      gameCards.forEach(cardId => {
        const card = document.createElement("div");
        card.classList.add("card");
        card.dataset.cardId = cardId;

        const inner = document.createElement("div");
        inner.classList.add("card-inner");

        const front = document.createElement("div");
        front.classList.add("card-front");
        front.style.backgroundImage = `url('${CARD_LIBRARY[cardId].image}')`;

        const back = document.createElement("div");
        back.classList.add("card-back");

        inner.appendChild(front);
        inner.appendChild(back);
        card.appendChild(inner);
        container.appendChild(card);
      });
    }
  </script>
  <script src="memoryGame.js?v=1.0.7"></script>
</body>
</html>